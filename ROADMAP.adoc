= Modshells Development Roadmap
:toc: macro
:toc-title: Contents
:toclevels: 2
:icons: font

Development roadmap for Modshells, the modular shell configuration manager.

toc::[]

== Current State: v0.0 (Alpha)

=== What Exists

[cols="1,2,1"]
|===
| Component | Description | Status

| `modshells.adb`
| Main entry point, initialisation flow
| Complete

| `Config_Store`
| Path resolution from env vars, home directory detection
| Complete

| `Shell_Manager.Create_Modshell_Directories`
| Idempotent directory creation (core, tools, misc, os, ui)
| Complete

| `Shell_Manager.Detect_Shells`
| Shell detection (10 shell types enumerated)
| Stub only

| `Shell_Manager.Is_Modularized`
| Signature-based idempotency check
| Partial

| `Shell_Manager.Modularise_Config`
| Backup + injection logic
| Stub only

| Build system
| GPRBuild project files, CI/CD
| Complete

| Documentation
| README, Contributing, Security, Citations
| Complete
|===

== Milestone 1: Core Functionality

Complete the foundational shell management capabilities.

=== 1.1 Shell Detection

Implement actual shell detection to replace the current stub.

* [ ] Detect installed shells via `which` / `command -v`
* [ ] Detect shells listed in `/etc/shells`
* [ ] Handle non-standard installation paths
* [ ] Return accurate `Shell_Status` (Installed, Not_Installed, Can_Be_Installed)
* [ ] Test on multiple Linux distributions

=== 1.2 Configuration File Location

Map each shell type to its configuration file(s).

* [ ] Define config file paths per shell
** Bash: `~/.bashrc`, `~/.bash_profile`
** Zsh: `~/.zshrc`, `~/.zprofile`
** Fish: `~/.config/fish/config.fish`
** Nushell: `~/.config/nushell/config.nu`
** Ion: `~/.config/ion/initrc`
** Oils: `~/.oshrc`, `~/.yshrc`
** Tcsh: `~/.tcshrc`, `~/.cshrc`
** Ksh: `~/.kshrc`
** Dash: requires `ENV` variable
** PowerShell: profile paths vary by platform
* [ ] Handle XDG Base Directory specification
* [ ] Support custom config locations

=== 1.3 Configuration Backup

Implement safe backup before modification.

* [ ] Create timestamped backup: `.bashrc.modshells-backup-20240101-120000`
* [ ] Configurable backup location
* [ ] Backup rotation (keep N most recent)
* [ ] Verify backup integrity before proceeding

=== 1.4 Source Injection

Inject sourcing logic into shell configurations.

* [ ] Generate shell-specific sourcing syntax
** POSIX shells: `for f in dir/*.sh; do . "$f"; done`
** Fish: `for f in dir/*.fish; source $f; end`
** Nushell: `source` with glob
** PowerShell: `Get-ChildItem | ForEach-Object { . $_ }`
* [ ] Inject between signature markers
* [ ] Handle different file extension conventions
* [ ] Respect alphabetical ordering of sourced files

== Milestone 2: Multi-Shell Orchestration

=== 2.1 Unified Modularisation

* [ ] `modshells init` - Modularise all detected shells
* [ ] `modshells init --shell=bash,zsh` - Modularise specific shells
* [ ] Interactive mode with shell selection
* [ ] Dry-run mode (`--dry-run`) showing planned changes

=== 2.2 Shell-Agnostic Configuration

* [ ] Define `.modshells` extension for cross-shell configs
* [ ] Transpilation layer for common syntax
** Common aliases â†’ shell-specific syntax
** Environment variables (portable)
** Path modifications
* [ ] Fall back to shell-specific files when needed

=== 2.3 Synchronisation

* [ ] Detect config drift (manual edits to modularised files)
* [ ] Re-sync modular structure from monolithic backup
* [ ] Import existing configurations into modular structure

== Milestone 3: Configuration Management

=== 3.1 Snippet Management

* [ ] `modshells add <category> <name>` - Create new snippet
* [ ] `modshells list` - List all snippets by category
* [ ] `modshells enable/disable <snippet>` - Toggle snippets
* [ ] Template system for common configurations

=== 3.2 Categories and Ordering

* [ ] Configurable category directories
* [ ] Explicit ordering via manifest file
* [ ] Dependency declaration between snippets
* [ ] Conditional loading (by hostname, OS, etc.)

=== 3.3 Validation

* [ ] Syntax checking before injection
* [ ] Lint shell configurations
* [ ] Detect conflicting aliases/functions
* [ ] Security audit (no exposed secrets)

== Milestone 4: Distribution and Integration

=== 4.1 Package Distribution

* [ ] Guix package definition (`guix.scm`)
* [ ] Nix flake (`flake.nix`)
* [ ] Binary releases for common platforms
* [ ] Container image for CI/CD integration

=== 4.2 Integration

* [ ] Starship prompt integration
* [ ] Direnv compatibility
* [ ] asdf/mise version manager integration
* [ ] Shell plugin manager compatibility (oh-my-zsh, fisher, etc.)

=== 4.3 Migration Tools

* [ ] Import from oh-my-zsh
* [ ] Import from prezto
* [ ] Import from bash-it
* [ ] Export to portable format

== Milestone 5: Advanced Features

=== 5.1 Remote Configuration

* [ ] Sync configurations via Git
* [ ] Encrypted secrets handling
* [ ] Machine-specific overlays
* [ ] Dotfiles repository integration

=== 5.2 Shell Session Management

* [ ] Profile switching (work/personal)
* [ ] Temporary configuration injection
* [ ] Session isolation

=== 5.3 Observability

* [ ] Shell startup time profiling
* [ ] Configuration load tracing
* [ ] Audit log of modifications

== Technical Debt

=== Code Quality

* [ ] Replace mock paths in `Is_Modularized` with actual config paths
* [ ] Implement comprehensive error messages
* [ ] Add logging with configurable verbosity
* [ ] Unit test suite with AUnit

=== Build System

* [ ] Complete `justfile` recipes (build, test, clean, fmt, lint)
* [ ] Add development container (`.devcontainer`)
* [ ] Cross-compilation for macOS and Windows
* [ ] Static linking for portable binaries

=== Documentation

* [ ] Man page (`modshells.1`)
* [ ] Shell completion scripts (bash, zsh, fish, nushell)
* [ ] Tutorial: "Modularising Your Shell in 5 Minutes"
* [ ] Architecture Decision Records (ADRs)

== Non-Goals

The following are explicitly out of scope:

* **Shell implementation** - Modshells manages configuration, not shell execution
* **Plugin system** - Use native shell plugin managers instead
* **Remote shell management** - Focus on local workstation configuration
* **GUI** - CLI-first design; TUI may be considered later

== Version Planning

[cols="1,2,1"]
|===
| Version | Milestone | Target

| v0.1
| Milestone 1 (Core Functionality)
| -

| v0.5
| Milestone 2 (Multi-Shell Orchestration)
| -

| v1.0
| Milestone 3 (Configuration Management)
| -

| v1.5
| Milestone 4 (Distribution and Integration)
| -

| v2.0
| Milestone 5 (Advanced Features)
| -
|===

== Contributing

See link:CONTRIBUTING.md[CONTRIBUTING.md] for contribution guidelines.

Priority areas for contribution:

1. Shell-specific expertise (especially Fish, Nushell, PowerShell)
2. Cross-platform testing (macOS, BSD, Windows via WSL)
3. Package definitions (Homebrew, AUR, RPM, DEB)
4. Documentation and tutorials
